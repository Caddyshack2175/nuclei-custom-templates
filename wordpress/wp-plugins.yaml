id:  wp-plugins

info:
  name: Find WordPress Plugins
  author: Caddyshack2175
  severity: info
  description: | 
    WordPress allows for the installation of plugins to enhance the features and functionality, and enhance user experience of the application. However keeping WordPress core as well as plugins updated is critical to security and functionality of WordPress applications.
  reference:
    - https://wordpress.org/plugins/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    cvss-score: 0.0
  tags: information, discloser, wordpress, default-files, wp-plugins, plugins, enum, enumeration

http:
  - raw:
      - |
        GET /wp-content/plugins/{{plugin}}/readme.txt HTTP/1.1
        Host: {{Host}}
        Upgrade-Insecure-Requests: 1
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6167.85 Safari/537.36
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
        Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
        Connection: close

    payloads:
      plugin:
        - elementor
        - contact-form-7
        - wordpress-seo
        - classic-editor
        - woocommerce
        - akismet
        - wpforms-lite
        - all-in-one-wp-migration
        - litespeed-cache
        - really-simple-ssl
        - wordfence
        - jetpack
        - duplicate-post
        - google-site-kit
        - wp-mail-smtp
        - updraftplus
        - wordpress-importer
        - all-in-one-seo-pack
        - duplicate-page
        - google-analytics-for-wordpress
        - redirection
        - seo-by-rank-math
        - tinymce-advanced
        - classic-widgets
        - insert-headers-and-footers
        - limit-login-attempts-reloaded
        - advanced-custom-fields
        - mailchimp-for-wp
        - essential-addons-for-elementor-lite
        - header-footer-elementor
        - wp-super-cache
        - astra-sites
        - sg-cachepress
        - loco-translate
        - duplicator
        - hostinger
        - optinmonster
        - disable-comments
        - wps-hide-login
        - wp-fastest-cache
        - google-sitemap-generator
        - cookie-law-info
        - wp-smushit
        - better-search-replace
        - regenerate-thumbnails
        - worker
        - elementskit-lite
        - loginizer
        - svg-support
        - custom-post-type-ui
        - instagram-feed
        - one-click-demo-import
        - w3-total-cache
        - wp-optimize
        - wp-file-manager
        - cookie-notice
        - autoptimize
        - envato-elements
        - sg-security
        - ewww-image-optimizer
        - all-in-one-wp-security-and-firewall
        - redux-framework
        - wp-multibyte-patch
        - breadcrumb-navxt
        - maintenance
        - coming-soon
        - complianz-gdpr
        - safe-svg
        - code-snippets
        - better-wp-security
        - smart-slider-3
        - google-listings-and-ads
        - yith-woocommerce-wishlist
        - imagify
        - woocommerce-gateway-stripe
        - sucuri-scanner
        - woocommerce-services
        - ninja-forms
        - tablepress
        - flamingo
        - the-events-calendar
        - hello-dolly
        - antispam-bee
        - polylang
        - popup-maker
        - premium-addons-for-elementor
        - user-role-editor
        - woocommerce-payments
        - duracelltomi-google-tag-manager
        - siteorigin-panels
        - mailpoet
        - wp-maintenance-mode
        - disable-gutenberg
        - mainwp-child
        - ocean-extra
        - meta-box
        - under-construction-page
        - post-types-order
        - broken-link-checker
        - facebook-for-woocommerce
        - ultimate-addons-for-gutenberg
        - creame-whatsapp-me
        - woocommerce-paypal-payments
        - backwpup
        - kirki
        - enable-media-replace
        - easy-wp-smtp
        - ml-slider
        - custom-css-js
        - so-widgets-bundle
        - wp-pagenavi
        - wp-statistics
        - shortcodes-ultimate
        - contact-form-cfdb7
        - ga-google-analytics
        - gtranslate
        - creative-mail-by-constant-contact
        - siteguard
        - header-footer-code-manager
        - taxonomy-terms-order
        - click-to-chat-for-whatsapp
        - nextgen-gallery
        - google-analytics-dashboard-for-wp
        - official-facebook-pixel
        - forminator
        - limit-login-attempts
        - easy-table-of-contents
        - really-simple-captcha
        - woo-checkout-field-editor-pro
        - pixelyoursite
        - amp
        - coblocks
        - malcare-security
        - font-awesome
        - megamenu
        - wpvivid-backuprestore
        - webp-converter-for-media
        - password-protected
        - mailchimp-for-woocommerce
        - kadence-blocks
        - add-to-any
        - fluentform
        - header-footer
        - happy-elementor-addons
        - pinterest-for-woocommerce
        - intuitive-custom-post-order
        - admin-menu-editor
        - contact-form-7-honeypot
        - wp-google-maps
        - post-smtp
        - wp-reset
        - wp-reviews-plugin-for-google
        - formidable
        - black-studio-tinymce-widget
        - otter-blocks
        - cmb2
        - woocommerce-pdf-invoices-packing-slips
        - child-theme-configurator
        - custom-fonts
        - ad-inserter
        - webp-express
        - health-check
        - newsletter
        - force-regenerate-thumbnails
        - leadin
        - metform
        - pdf-embedder
        - royal-elementor-addons
        - shortpixel-image-optimiser
        - translatepress-multilingual
        - breeze
        - woo-variation-swatches
        - table-of-contents-plus
        - fast-indexing-api
        - stops-core-theme-and-plugin-updates
        - nextend-facebook-connect
        - gutenberg
        - copy-delete-posts
        - jetpack-boost
        - widget-importer-exporter
        - gdpr-cookie-compliance
        - templately
        - wpcf7-redirect
        - wp-migrate-db
        - wp-sitemap-page
        - simple-custom-post-order
        - host-webfonts-local
        - wpcf7-recaptcha
        - pretty-link
        - favicon-by-realfavicongenerator
        - wp-seopress
        - imsanity
        - members
        - wp-rollback
        - iwp-client
        - velvet-blues-update-urls
        - sticky-header-effects-for-elementor
        - astra-widgets
        - woo-cart-abandonment-recovery
        - use-any-font
        - loginpress
        - all-404-redirect-to-homepage
        - popup-builder
        - simple-history
        - cmp-coming-soon-maintenance
        - easy-fancybox
        - wp-crontrol
        - cloudflare
        - post-duplicator
        - unlimited-elements-for-elementor
        - woocommerce-google-analytics-integration
        - call-now-button
        - backuply
        - chaty
        - header-and-footer-scripts
        - wp-user-avatar
        - simple-user-avatar
        - white-label-cms
        - aryo-activity-log
        - photo-gallery
        - wp-whatsapp-chat
        - themeisle-companion
        - php-compatibility-checker
        - wp-mail-logging
        - userfeedback-lite
        - eps-301-redirects
        - cyr2lat
        - fluent-smtp
        - cartflows
        - simple-page-ordering
        - ssl-insecure-content-fixer
        - wp-security-audit-log
        - easy-google-fonts
        - image-optimization
        - adminimize
        - yith-woocommerce-compare
        - woocommerce-gateway-paypal-express-checkout
        - mw-wp-form
        - ultimate-member
        - user-switching
        - page-links-to
        - customizer-export-import
        - optimole-wp
        - generateblocks
        - woosidebars
        - cleantalk-spam-protect
        - so-css
        - wordpress-popular-posts
        - kadence-starter-templates
        - simple-301-redirects
        - post-type-switcher

    attack: clusterbomb
    threads: 30
    redirects: false
    stop-at-first-match: false
    matchers-condition: and
    matchers:
      - type: regex
        part: body
        condition: and
        regex:
          - 'Stable tag'
      - type: status
        status:
          - 200

    extractors:
      - type: regex
        name: plugin
        group: 1
        regex:
          - 'Stable tag: (.*)'